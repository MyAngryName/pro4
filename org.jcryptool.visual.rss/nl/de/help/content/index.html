<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
	<title>Schwärzbare Signaturverfahren</title>
</head>

<body>
<h1>Schwärzbare Signaturverfahren</h1>
<p>
	Digitale Signaturverfahren werden verwendet, um die Datenintegrität und die Authentifizierung der Datenherkunft für eine signierte Nachricht zu gewährleisten. Ein schwärzbares Signaturschema ermöglicht die Signatur einer Nachricht so, dass, wenn bestimmte Teile der signierten Nachricht, die als Felder oder Nachrichtenteile bezeichnet werden, geschwärzt (gelöscht, ausgeblendet oder dauerhaft entfernt) werden, die Signatur der geschwärzten Nachricht im Hinblick auf ihre Integrität und Herkunftsauthentifizierung dennoch überprüft werden kann.
</p>
<p>
	Derjenige, der den privaten Signaturschlüssel kennt, kann beim Signieren einer Nachricht festlegen, welche Teile der Nachricht später (im Sinne von ISO/IEC 27038) von einer beliebigen Stelle, die nur die Nachricht, die Signatur und den öffentlichen Schlüssel zum Schwärzen kennt, geschwärzt werden können. Jede andere Änderung der signierten Nachricht (z. B. Schwärzen anderer Nachrichtenteile oder Einfügen/Ändern beliebiger Teile) macht die durch die Signatur gegebene Signatur ungültig.
</p>
<p>
	Schwärzbare Signaturverfahren können als grundlegender Baustein in vielen Anwendungen mit Datenschutz dienen, z. B. bei der gemeinsamen Nutzung von Daten oder bei der Authentifizierung, bei der eine Einrichtung beschließen kann, nur die Informationen aus einem größeren Satz signierter Informationen offenzulegen, die unbedingt an einen Empfänger weitergeleitet werden müssen, während letzterer immer noch sicher sein kann, dass die empfangenen Informationen zuvor beglaubigt wurden, z. B. durch eine öffentliche Stelle.  
</p>

<p>
Folgende Schema-Varianten können im Schritt <b>Neuer Schlüssel</b> ausgewählt werden:<br/>
<br/>
<b>1)</b> <a href="#GLRSS"><b>Akkumulatorbasiertes RSS für lineare Dokumente (GLRSS)</b></a><br/>
<br/>
<b>2)</b> <a href="#GSRSS"><b>Akkumulatorbasiertes RSS für Mengen (GSRSS)</b></a><br/>
<br/>
<b>3)</b> <a href="#GenericConstruction"><b> Generische Konstruktion auf Basis von Hash-Trees (GC)</b></a><br/>
<br/>
<b>4)</b> <a href="#SBZ02-MersaProd"><b>Konstruktion auf Basis des Mehrkomponenten-RSA-Algorithmus (SBZ01-MERSAProd)</b></a><br/>
</p>
<p>GLRSS und GSRSS basieren auf dem <a href="#BPA"><b>Baric Pfitzman Accumulator (BPA)</b></a>.</p>
<br>

<h2 id="BPA">Baric-Pfitzman-Akkumulator (BPA)</h2>
<p>Ein Akkumulatorschema ermöglicht es, eine endliche Menge X als einen einzigen prägnanten Wert, den sogenannten Akkumulator, darzustellen. Eine Partei, die im Besitz eines Geheimnisses ist, kann für jedes Element x von X einen so genannten Zeugen berechnen, der die Zugehörigkeit von x zu X bestätigt. Ohne das Geheimnis ist es nicht möglich, verifizierende Zeugen zu erzeugen. Ohne einen Zeugen ist es nicht möglich, zu überprüfen, ob x ein Element von X war, auch wenn man den Akkumulator kennt.</p>
<p>Die Implementierung in JCrypTool setzt das ursprünglich von Barić und Pfitzmann vorgeschlagene Akkumulatorschema um. Es wurde leicht angepasst als "Indistinguishability of One-Way Accumulators" von De Meer, Liedl, Pöhls, Posegga und Samelin veröffentlicht (verfügbar als MIP-1210 unter https://www.fim.uni-passau.de/forschung/technische-berichte/mip-1210/).</p>
<p>Die ursprüngliche Arbeit von Baric und Pfitzmann wurde als "Collision-Free Accumulators and Fail-Stop Signature Schemes Without Trees" veröffentlicht (verfügbar in Proc. of Advances in Cryptology - EUROCRYPT '97, volume 1233 of LNCS, pages 480-494. Springer, 1997).</p>

<h2 id="GLRSS">Akkumulatorenbasierte RSS für lineare Dokumente (GLRSS)</h2>
	<p>RSS für lineare Dokumente (GLRSS) basiert auf einem kryptographischen Akkumulatorschema mit bestimmten kryptographischen Eigenschaften (z.B. BPA) und einem digitalen Signaturverfahren (z.B. RSA).<p>
<p>Ein Akkumulatorschema ermöglicht es, eine endliche Menge X als einen einzigen prägnanten Wert, den sogenannten Akkumulator, darzustellen. Eine Partei, die im Besitz eines Geheimnisses ist, kann für jedes Element x von X einen so genannten Zeugen berechnen, der die Zugehörigkeit von x zu X bestätigt. Ohne das Geheimnis ist es nicht möglich, verifizierende Zeugen zu erzeugen. Ohne einen Zeugen ist es nicht möglich, zu überprüfen, ob x ein Element von X war, auch wenn man den Akkumulator kennt.</p>
	<p>Auf der Grundlage der obigen Ausführungen ist das GSRSS wie folgt aufgebaut: Es berechnet einen Akkumulatorwert und alle Zeugen, für die zu signierende Menge, und signiert dann den Akkumulatorwert mit einem beliebigen digitalen Signaturverfahren. Zur Verifizierung werden dem Verifizierer einfach die Zeugen für jedes Element der Menge zur Verfügung gestellt, und es wird überprüft, ob die digitale Signatur auf dem Akkumulator sowie die Zeugen gültig sind. Bei der Schwärzung werden die Zeugen, die den geschwärzten Elementen entsprechen, einfach gelöscht.</p>
	<p>Um die Reihenfolge der Nachrichtenteile zu kodieren, wird besonders darauf geachtet, dass nicht nur Indizes verwendet werden. Das Verwenden von Indizes würde nicht zur „Undetec führen, sondern manchmal ihre Positionen offenbaren, z.B. würde das Redacting einer signierten Liste {1:A,2:B,3:C,4:D,5:E} in {1:A,4:D} offenbaren, dass 2 Elemente zwischen A und D entfernt wurden. Dies bietet die kryptografische Eigenschaft der „undetectability of redactions“ (in der ursprünglichen Arbeit als "transparency" bezeichnet, was leider mehrdeutig ist). „Undetectability of redactions“ bedeutet, dass ein Angreifer eine signierte Originalnachricht nicht von einer geschwärzten signierten Nachricht unterscheiden kann.</p>>
	<p>Dieses schwärzbare Signaturschema erlaubt es, <b>die Integrität und die Datenherkunft für den Inhalt sowie die Reihenfolge der Nachrichtenteile zu schützen</b>, zusätzlich erlaubt es dem Signierer, <b>zu definieren, welche Teile der Nachricht unveränderlich</b>. Bei der Signaturerstellung definiert der Signierer die Reihenfolge der Nachrichtenteile und für jeden Nachrichtenteil, ob er öffentlich geschwärzt werden kann.</p>
	<p><b>Öffentliche Schwärzung</b>  (oder <b>public redaction</b>) bedeutet, dass der jeweilige schwärzbare Nachrichtenteil aus der Menge entfernt werden kann, wenn der Signierer dies genehmigt, ohne dass zusätzliche Schlüssel benötigt werden.</p>
	<p>Dieses Verfahren ist <b>fälschungssicher</b> (oder <b>unforgeable</b>, d.h. der Angreifer, der nicht im Besitz des geheimen Signaturschlüssels ist, kann keine Signatur erzeugen, die eine Nachricht verifiziert. Ausgenommen davon sind diejenigen Nachrichten, die durch eine oder mehrere autorisierte - und damit öffentliche - Schwärzungen erzeugt werden können.</p>
	<p>Schließlich ist die <b>Schwärzung privat</b>, so dass die geschwärzte Nachricht keine Informationen über den Inhalt des Teils der Nachricht preisgibt, der geschwärzt wurde. Das heißt der Angreifer kann beim Anblick einer geschwärzten Nachricht, die nur m2="C" enthält und durch Schwärzten von m1 erzeugt wurde, weder von einer ursprünglichen Nachricht m=m1,m2 mit m1="A" noch von einer ursprünglichen Nachricht m'=m1',m2 mit m1'="B" unterscheiden.</p>
	<p>Außerdem ist es <b>unerkennbar, ob zuvor eine Schwärzung stattgefunden hat.</b></p>
	
	<p>GSRSS + GLRSS wurden von David Derler, Henrich C. Pöhls, Kai Samelin und Daniel Slamanig unter dem Titel "A general framework for redactable signatures and new constructions" in Soonhak Kwon und Aaram Yun, editors, Information Security and Cryptology - ICISC 2015, pages 3-19, Springer, 2016 veröffentlicht.</p>
 
<h2 id="GSRSS">Akkumulatorenbasierte RSS für Mengen (GSRSS)</h2>
	<p>RSS für Mengen (GSRSS) basiert auf einem kryptographischen Akkumulatorschema mit bestimmten kryptographischen Eigenschaften (z.B. BPA) und einem digitalen Signaturschema (z.B. RSA).</p>
<p>Ein Akkumulatorschema ermöglicht es, eine endliche Menge X als einen einzigen prägnanten Wert, den sogenannten Akkumulator, darzustellen. Eine Partei, die im Besitz eines Geheimnisses ist, kann für jedes Element x von X einen so genannten Zeugen berechnen, der die Zugehörigkeit von x zu X bestätigt. Ohne das Geheimnis ist es nicht möglich, verifizierende Zeugen zu erzeugen. Ohne einen Zeugen ist es nicht möglich, zu überprüfen, ob x ein Element von X war, auch wenn man den Akkumulator kennt.</p>
	<p>Auf der Grundlage der obigen Ausführungen ist das GSRSS wie folgt aufgebaut: Es berechnet einen Akkumulatorwert und alle Zeugen, die die zu signierende Menge darstellen, und signiert dann den Akkumulatorwert mit einem beliebigen digitalen Signaturverfahren. Zur Verifizierung werden dem Verifizierer einfach die Zeugen für jedes Element der Menge zur Verfügung gestellt, und es wird überprüft, ob die digitale Signatur auf dem Akkumulator sowie die Zeugen gültig sind. Bei der Schwärzung werden die Zeugen, die den geschwärzten Elementen entsprechen, einfach weggeworfen.  Das veröffentlichte Schema bietet keine Kontrolle darüber, welches Element der Menge geschwärzt werden kann und welches nicht, es sind immer alle Elemente schwärzbar. Dies bietet die kryptografische Eigenschaft der „undetectability of redactions“ (in der ursprünglichen Arbeit als "transparency" bezeichnet, was leider zweideutig ist). Undetectability of redactions“ bedeutet, dass ein Angreifer eine signierte Originalnachricht nicht von einer geschwärzten signierten Nachricht unterscheiden kann, z.B. sieht ein direkt signiertes {A,D} ununterscheidbar aus von {A,D}, das durch Schwärzung eines signierten {A,B,C,D,E} erhalten wurde.</p>

	<p>Dieses schwärzbare Signaturschema erlaubt es,<strong>den Inhalt der Nachrichtenteile zu schützen, aber nicht ihre Reihenfolge</strong>. Stellen Sie sich die Nachrichtenteile als eine Menge im mathematischen Sinne vor.<p>
	<p>Zusätzlich erlaubt es dem Signierer <strong>zu definieren, welche Teile der Nachricht unveränderlich</strong> sind. Bei der Signaturerstellung legt der Signierer fest, welche Teile der Nachricht sich voneinander unterscheiden und ob jeder Teil der Nachricht öffentlich geschwärzt werden kann.</p> <p>
	<p><strong>Öffentliche Schwärzung</strong> bedeutet, dass der jeweilige schwärzbare Nachrichtenteil aus der Menge entfernt werden kann, wenn der Signierer dies genehmigt, ohne dass zusätzliche Schlüssel benötigt werden.</p>
	<p>Dieses Verfahren ist <b>fälschungssicher</b> (oder <b>unforgeable</b>, d.h. der Angreifer, der nicht im Besitz des geheimen Signaturschlüssels ist, kann keine Signatur erzeugen, die eine Nachricht verifiziert. Ausgenommen davon sind diejenigen Nachrichten, die durch eine oder mehrere autorisierte - und damit öffentliche - Schwärzungen erzeugt werden können.</p>
	<p>Schließlich ist die <b> Schwärzung privat </b>, so dass die geschwärzte Nachricht keine Informationen über den Inhalt des geschwärzten Nachrichtenteils preisgibt, d.h. der Gegner kann eine geschwärzte Nachricht, die nur m2=&ldquo;C&rdquo; enthält und durch Schwärzen von m1 erzeugt wurde, nicht von einer ursprünglichen Nachricht m=m1,m2 mit m1=&rdquo;A&rdquo; oder einer ursprünglichen Nachricht m&rsquo;=m1&rsquo;,m2 mit m1&rsquo;=&rdquo;B&rdquo; unterscheiden.</p>
	<p>Außerdem ist es <b>unerkennbar, ob zuvor eine Schwärzung stattgefunden hat.</b></p>
	
	<p>GSRSS + GLRSS wurden von David Derler, Henrich C. Pöhls, Kai Samelin und Daniel Slamanig unter dem Titel "A general framework for redactable signatures and new constructions" in Soonhak Kwon und Aaram Yun, editors, Information Security and Cryptology - ICISC 2015, pages 3-19, Springer, 2016 veröffentlicht.</p>
 

	
	<h2 id="GenericConstruction">Generische Konstruktion auf Basis von Hash-Trees (GC)</h2>
	<p>Die generische Konstruktion (GC) basiert auf einem Merkle-Hash-Baum (siehe <a href="https://en.wikipedia.org/wiki/Merkle_tree">https://en.wikipedia.org/wiki/Merkle_tree</a>). Der Hash-Baum ist ein Baum, in dem jeder Blattknoten den kryptographischen Hash eines Datenblocks und jeder Nicht-Blattknoten den kryptographischen Hash der Labels seiner Kindknoten enthält.</p>
	<p>Jeder Blattknoten wird generiert, indem der Inhalt des Nachrichtenteils zusammen mit zwei Zufallswerten gehasht wird (einer, der für alle Nachrichtenteile gleich ist und einer, der für jeden Nachrichtenteil einzeln zufällig gewählt wird). Mit anderen Worten, der Inhalt der Nachrichtenteile und ein Zufallswert sind die Datenblöcke, über die der Hash-Baum aufgebaut wird.</p>
	<p>Eine kryptographisch sichere Hash-Funktion (z.B. SHA-3) muss verwendet werden und der Root-Hash hängt von jedem Nachrichtenteil ab. Der Root-Hash wird schließlich mit einem digitalen Signaturverfahren (z. B. RSA) signiert.</p>
	<p>Das Schwärzen von Nachrichtenteilen bedeutet, dass ihr Inhalt und ihr Zufallswert aus der Nachricht entfernt und nur durch den Hash ersetzt wird. Das veröffentlichte Schema bietet keine Kontrolle darüber, welches Element der Menge geschwärzt werden kann und welches nicht, es sind immer alle Elemente schwärzbar.</p>
	<p>Das Schema erfordert außerdem die Bereitstellung des Hashes für jeden der geschwärzten Nachrichtenteile und bietet somit die kryptografische Eigenschaft der „detectability of redactions“. „Detectability of redactions“ bedeutet, dass jeder Dritte eine signierte Originalnachricht von einer geschwärzten signierten Nachricht unterscheiden kann. Z. B. ist eine direkt signierte Nachricht {A,D} unterscheidbar von {A,-,-,D,-}, die durch Schwärzung einer signierten Nachricht {A,B,C,D,E} erhalten wurde. Vorausgesetzt  ist hierbei, dass "-" als spezielles Zeichen verwendet, um einen geschwärzten Nachrichtenteil anzuzeigen.</p>
	<p>Darüber hinaus würde das Schema erlauben, zwei verschiedene geschwärzte Versionen, die aus demselben übergeordneten Dokument (identifiziert durch denselben nachrichtenweiten Zufallswert) generiert wurden, zusammenzuführen. Z.B. können {A,-,-} und {-,B,-} zu {A,B,-} zusammengeführt werden, wenn beide durch Schwärzens eines signierten {A,B,C} erhalten wurden., Der Inhalt des letzten Nachrichtenteils C bleibt allerdings privat, d.h. man kann keine Informationen über diesen Inhalt erlangen.</p>
	
    <p>Dieses schwärzbare Signaturschema erlaubt es, den Inhalt von Nachrichtenteilen sowie deren Reihenfolge zu schützen. Nach der Signaturerstellung können alle Nachrichtenteile öffentlich geschwärzt werden.
	<p><b>Öffentliche Schwärzung</b>  (oder <b>public redaction</b>) bedeutet, dass der jeweilige schwärzbare Nachrichtenteil aus der Menge entfernt werden kann, wenn der Signierer dies genehmigt, ohne dass zusätzliche Schlüssel benötigt werden.</p>
	<p>Dieses Verfahren ist <b>fälschungssicher</b> (oder <b>unforgeable</b>, d.h. der Angreifer, der nicht im Besitz des geheimen Signaturschlüssels ist, kann keine Signatur erzeugen, die eine Nachricht verifiziert. Ausgenommen davon sind diejenigen Nachrichten, die durch eine oder mehrere autorisierte - und damit öffentliche - Schwärzungen erzeugt werden können.</p>
    <p>Schließlich ist die <b>Schwärzung privat</b>, so dass die geschwärzte Nachricht keine Informationen über den Inhalt des geschwärzten Nachrichtenteils preisgibt. Somit kann der Angreifer eine geschwärzte Nachricht, die nur m2=&ldquo;C&rdquo; enthält und durch Schwärzen von m1 erzeugt wurde, nicht von einer ursprünglichen Nachricht m=m1,m2 mit m1=&rdquo;A&rdquo; oder einer ursprünglichen Nachricht m&rsquo;=m1&rsquo;,m2 mit m1&rsquo;=&rdquo;B&rdquo; unterscheiden.</p>
    <p>Eine vorangegangene Schwärzung bleibt jedoch <strong>nachweisbar</strong> bzw. <strong>detectable</strong>, d.h. hinterlässt eine Spur.</p>
    
    <p>GC + SBZ01-MERSAProd wurden von R. Steinfeld, L. Bull und Y. Zheng als "Content extraction signatures" in ICISC 2001 veröffentlicht.</p>
 
<h2 id="SBZ02-MersaProd">Konstruktion auf Basis des Mehrkomponenten-RSA-Algorithmus (SBZ01-MERSAProd)</h2>
	<p>Der SBZ01-MERSAProd-Algorithmus hat seinen Namen von der ursprünglichen Arbeit. Er basiert auf dem RSA-Algorithmus.</p>
	<p>Jeder Nachrichtenteil erfordert ein Paar von öffentlichen/privaten Exponenten, die auf der Grundlage des RSA-Mehrexponenten-Algorithmus generiert werden (siehe Originalarbeit <a href="https://link.springer.com/chapter/10.1007/0-387-34805-0_17">https://link.springer.com/chapter/10.1007/0-387-34805-0_17</a> oder eine kurze Beschreibung <a href="https://cryptome.org/jya/fiat-rsa.htm">https://cryptome.org/jya/fiat-rsa.htm</a>). Kurz gesagt ermöglicht er es, einen RSA-Signaturwert (auch Batch-Signatur genannt) aus vielen RSA-Signaturen zu erzeugen, solange diese Signaturen aus Parametern mit demselben Modulus (N) erzeugt werden. Bei der Schlüsselerstellung muss also ein Schlüsselpaar erzeugt werden, das so viele Exponenten für denselben Modulus enthält, wie Nachrichtenteile. Da es sich um RSA handelt, könnte man fehlende Exponentenpaare auch später erzeugen, wenn man die Faktorisierung des Moduls noch kennt, aber man hätte nicht die Möglichkeit, die öffentlichen Exponenten im öffentlichen Schlüssel vorab zu teilen oder zu zertifizieren.</p>
	<p>Jeder Nachrichtenteil wird mit einem Exponenten des öffentlichen Schlüssels signiert, und die Signatur für die Nachricht ist die akkumulierte Signatur aller Signaturen der Nachrichtenteile. Das Entfernen eines Teils einer Nachricht würde bedeuten, dass die Signatur dieses Teils aus der Gesamtsignatur entfernt wird. Daher müssen für die Schwärzung zunächst alle Einzelsignaturen aus der Stapelsignatur extrahiert werden, wobei die Informationen aus den ursprünglichen Nachrichtenteilen verwendet werden. Dann wird der Nachrichtenteil entfernt und die Stapelsignatur ohne die Einzelsignatur des entfernten Teils neu errechnet. Auch hier wird ein Zufallswert pro Nachricht hinzugefügt, um die Vermischung von Nachrichtenteilen aus einzelnen Nachrichten zu vermeiden.</p>
	<p>Das veröffentlichte Schema bietet die Möglichkeit, zu kontrollieren, welche Elemente der Menge geschwärzt werden können und welche nicht, indem diejenigen, die nicht geschwärzt werden können, in einer signierten Richtlinie aufgeführt werden. </p>
	<p>Das Schema erfordert außerdem die Bereitstellung von Informationen, d. h. des Hashs, für jeden der geschwärzten Nachrichtenteile und bietet somit die kryptografische Eigenschaft der „detectability of redactions“. „Detectability of redactions“ bedeutet, dass jeder Dritte eine signierte Originalnachricht von einer geschwärzten signierten Nachricht unterscheiden kann. Z. B. sieht eine direkt signierte Nachricht {A,D} unterscheidbar aus von {A,-,-,D,-}, die durch Schwärzung einer signierten Nachricht {A,B,C,D,E} erhalten wurde. Hierbei wird vorausgesetzt, dass "-" als spezielles Zeichen verwendet wird, um einen geschwärzten Nachrichtenteil anzuzeigen.</p>
	<p>Darüber hinaus würde das Schema es ermöglichen, zwei verschiedene geschwärzte Versionen, die aus demselben übergeordneten Dokument erzeugt wurden (identifiziert durch denselben nachrichtenweiten Zufallswert), zusammenzuführen.</p>

	<p>Dieses schwärzbare Signaturschema erlaubt es, den Inhalt von Nachrichtenteilen sowie deren Reihenfolge zu schützen. Nach der Signaturerstellung können alle Nachrichtenteile öffentlich geschwärzt werden.</p> </p>
	<p><strong>Öffentliches Schwärzen</strong> bedeutet, dass der jeweilige schwärzbare Nachrichtenteil aus der Menge entfernt werden kann, wenn der Unterzeichner dies genehmigt, ohne dass zusätzliche Schlüssel benötigt werden.</p>
	<p>Dieses Verfahren ist <b>fälschungssicher</b> (oder <b>unforgeable</b>, d.h. der Angreifer, der nicht im Besitz des geheimen Signaturschlüssels ist, kann keine Signatur erzeugen, die eine Nachricht verifiziert. Ausgenommen davon sind diejenigen Nachrichten, die durch eine oder mehrere autorisierte - und damit öffentliche - Schwärzungen erzeugt werden können.</p>
    <p>Schließlich ist die <b>Schwärzung privat</b>, so dass die geschwärzte Nachricht keine Informationen über den Inhalt des geschwärzten Nachrichtenteils preisgibt. Somit kann der Angreifer eine geschwärzte Nachricht, die nur m2=&ldquo;C&rdquo; enthält und durch Schwärzen von m1 erzeugt wurde, nicht von einer ursprünglichen Nachricht m=m1,m2 mit m1=&rdquo;A&rdquo; oder einer ursprünglichen Nachricht m&rsquo;=m1&rsquo;,m2 mit m1&rsquo;=&rdquo;B&rdquo; unterscheiden.</p>
    <p>Eine vorangegangene Schwärzung bleibt jedoch <strong>nachweisbar</strong> bzw. <strong>detectable</strong>, d.h. hinterlässt eine Spur.</p>
	
	<p>GC + SBZ01-MERSAProd wurden von R. Steinfeld, L. Bull und Y. Zheng als "Content extraction signatures" in ICISC 2001 veröffentlicht.</p>
</body>
</html>
